# Configure logging
logging:
  level: 20

# Configure mlflow
mlflow:
  # tracking_uri: "http://127.0.0.1:5000"
  # experiment_name: "test-experiment"
  # run_name: test
  # artifact_location: "path/to/artifacts"

# Configure Yarn
yarn:
  name: test
  # zip_file: "path/to/env.pex"  # Reuse existing pex
  # package_path: "hdfs://root/user/..."  # Target path (where to upload the env.pex)
  # num_cores: 8  # Number of executor's cores
  # memory: "32 GiB" # Executor's memory
  # jvm_memory_in_gb: 8  # JVM memory
  # env_vars:  # Environment variables to forward to yarn
    # - CUDA_VISIBLE_DEVICES

# Configure launcher
launcher:
  parse:
    # Log non-parsed config
    - _attr_: mlflow
      log_artifacts: true
      log_params: false
      path_config: "config.yaml"
      path_command: "launch_config.txt"
    # Parse config
    - parser
    # Log parsed config and log flattened config as parameters
    - _attr_: mlflow
      log_artifacts: true
      log_params: true
      path_config: "parsed.yaml"
      path_command: "launch_parsed.txt"
      include_keys:
        - model
  run:
    # Forward the launch to a distant machine with yarn
    - yarn
    # Reactivate the MlFlow run on the distant machine, don't log anything
    - _attr_: mlflow
      log_artifacts: false
      log_params: false
    # Run locally on the distant machine
    - local
